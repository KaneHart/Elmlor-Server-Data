//First Quest, Help Andrew get his Maggot Slime for his Drink!
001-001-1.gat,27,18,0|script|Andrew|116,
{
    set @state, ((QUEST_AndrewSlime & NIBBLE_0_MASK) >> NIBBLE_0_SHIFT);
    if (@state >= 2) goto L_Done;
    if (@state == 1) goto L_Progress;
    goto L_Start;

L_Start:
    mes "[Andrew]";
    mes "\"I'm thirsty and would like to drink Maggot Slime. Would you be willing to bring me 2 Maggot Slimes?\"";
    next;
    mes "\"I will give you a dagger in return?\"";
    menu
        "For a Dagger? Sure!", L_accept,
        "Not today Gramps.", L_Close;

L_accept:
    mes "[Andrew]";
    mes "\"Thank you so much!  I'll wait here for you here.\"";
    set @state, 1;
    callsub S_Update_Var;
    close;

L_Progress:
    mes "[Andrew]";
    mes "\"Did you bring me the five Maggot Slimes I need?\"";
    next;
    menu
        "Yes, here they are you Sick Old Man!", L_try,
        "Not yet, but I'll be back soon.", L_Close;

L_try:
    if (countitem("MaggotSlime") >= 2)
        goto L_get;
    mes "[Andrew]";
    mes "\"It doesn't look like you have them all...\"";
    goto L_Close;

L_get:
    delitem "MaggotSlime", 2;
    getitem "Dagger", 1;
    set @state, 2;
    callsub S_Update_Var;
    mes "[Andrew]";
    mes "\"Ooh!  Thank you so much!  I can't wait to drink this!\"";
    goto L_Close;

L_Done:
    mes "[Andrew]";
    mes "\"Don't bother me! You made me sick!\"";
    goto L_Close;

L_Close:
    close;
    
S_Update_Var:
    set QUEST_AndrewSlime, (QUEST_AndrewSlime & ~(NIBBLE_0_MASK) | (@state << NIBBLE_0_SHIFT));
    return;

}